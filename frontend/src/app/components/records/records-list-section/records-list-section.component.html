<section class="forms-container">

  <div *ngIf="isLoadingRecords" class="loading-circle">
    <div class="spinner"></div>
    <p>A carregar records...</p>
  </div>

  <div *ngIf="!isLoadingRecords" class="selectOptionContainer">
    <div class="overflow-x-auto relative">
      <table class="user-table min-w-full bg-white">
        <thead class="bg-main-blue text-fill-white">
          <tr>
            <th class="w-1/3 p-2">Nome do Indicador (SAI)</th>
            <th class="w-1/3 p-2">Valor Mês</th>
            <th class="w-1/3 p-2">Ação</th>
          </tr>
        </thead>

        <tbody>
          <ng-container *ngIf="!isLoading">
            <tr *ngFor="let record of records; trackBy: trackByIndex" class="hover:bg-gray-100">
              <td class="p-2">{{ record.indicatorName }}</td>


              <td class="p-2">
                <form>   
                  <input [disabled]="record.isInserted" class="inputContainer--input w-full p-2 border border-gray-300 rounded"
                  [(ngModel)]="record.value" (ngModelChange)="onValueChange(record)" name="recordValue">
                </form>
              </td>


              <td class="p-2 text-center">
                <button *ngIf="!record.isUpdating" (click)="UpdateRecord(record)" class="forms-Button bg-main-blue text-white px-4 py-2 rounded disabled:opacity-50"
                  type="button">
                  {{ !record.isInserted ? 'Atualizar' : 'Editar' }} 
                </button>
                <div *ngIf="record.isUpdating" class="loading-circle">
                  <div class="spinner spinner_updateRecord-special"></div>
                </div>
              </td>

<!--               <td class="p-2">
                <form [formGroup]="indicatorForms[record.sai_id!]">   
                    <input class="inputContainer--input w-full p-2 border border-gray-300 rounded"
                      [formControlName]="'recordValue' + i" (input)="onValueChange(record, $event, i)">

                </form>
              </td> -->





            </tr>
          </ng-container> 



<!--           <ng-container *ngIf="!isLoading">
            <tr *ngFor="let record of records; trackBy: trackByIndex" class="hover:bg-gray-100">
              <td class="p-2">{{ record.record_name }}</td>
              <td class="p-2">
                <form [formGroup]="indicatorForms[record.sai_id!]">   
                  <ng-container *ngFor="let record of record.records; let i = index">
                    <input class="inputContainer--input w-full p-2 border border-gray-300 rounded"
                      [formControlName]="'recordValue' + i" (input)="onValueChange(record, $event, i)">
                  </ng-container>
                </form>
              </td>
              <td class="p-2 text-center">
                <button type="button" [disabled]="!indicatorForms[record.sai_id!].valid && !record.isInserted"
                  class="forms-Button bg-main-blue text-white px-4 py-2 rounded disabled:opacity-50"
                  (click)="toggleEdit(record)"> {{ !record.isInserted ? 'Atualizar' : 'Editar' }} </button>
              </td>
            </tr>
          </ng-container> -->
        </tbody>
      </table>
    </div>
  </div>
</section>
